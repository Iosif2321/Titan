# ROADMAP

Формат ведения:

- Каждый пункт имеет статус [ ] / [x].
- Пункты отсортированы по убыванию эффективности.
- Для каждого пункта указаны сложность и затраты реализации.
- Под пунктом фиксируйте результат и промежуточные изменения с эффектом.

# *28.12.2025*

## Приоритет (по эффективности)

1. [x] Стабилизировать сбор данных WS: авто-reconnect, контроль пропусков, дедупликация, confirm-свечи, REST-догрузка. (Сложность: высокая; Затраты: средние)
    Результат: добавлены контроль разрывов, дедупликация и REST-догрузка; статистика качества данных пишется в summary.
    Промежуточные изменения: live-тест `runs/live_ws_stable` (candles=3, gaps=0, backfilled=0, duplicates=0, out_of_order=0).
2. [x] Volatility-gating: при высокой волатильности снижать вес TRENDVIC и/или повышать пороги. (Сложность: средняя; Затраты: низкие)
    Результат: добавлен gating на vol_z (ensemble.vol_z_high) с понижением веса TRENDVIC и повышением flat/margin порогов.
    Промежуточные изменения: history-тест `runs/history_volgate_20251228_233653` (accuracy=40.34%, conf_wrong=63.27%, cumulative_return=-0.1565%).
3. [ ] Shock-режим: при резком возврате/спайке включать консервативный режим на 1-2 бара. (Сложность: средняя; Затраты: низкие)
    Результат:
    Промежуточные изменения:
4. [ ] Clamp strength TRENDVIC: ограничить strength/temperature scaling для снижения уверенных ошибок. (Сложность: низкая; Затраты: низкие)
    Результат:
    Промежуточные изменения:
5. [ ] OSCILLATOR-gating: использовать осциллятор только при RSI-экстремумах. (Сложность: низкая; Затраты: низкие)
    Результат:
    Промежуточные изменения:

Промежуточное изменение перед пунктом 6: дать возможность подгружать/просматривать необходимый прошедший период исторических данных для прогрева фичей.
    Результат: реализован prefill для history-теста с учетом окон фичей и eval-buffer.
    Промежуточные изменения: тест `runs/history_prefill` (target_candles=120, total_predictions=119, skipped_predictions=1; метаданные prefill записаны в summary).

6. [ ] Динамический порог FLAT и margin на скользящем окне по качеству/убыткам. (Сложность: средняя; Затраты: низкие)
    Результат:
    Промежуточные изменения:
7. [x] Онлайн-калибровка уверенности (confidence bins -> correction). (Сложность: средняя; Затраты: низкие)
    Результат: добавлен online-calibrator по confidence bins (blend/min_samples/decay) с записью состояния в summary.
    Промежуточные изменения: history-тест `runs/history_calib_20251229_004622` (accuracy=36.97%, ECE=26.54%, conf_wrong=65.52%).
8. [ ] Снижение уверенных ошибок: конфликт паттерн vs ансамбль -> снижение уверенности или FLAT. (Сложность: средняя; Затраты: низкие)
    Результат:
    Промежуточные изменения:
9. [ ] Усилить паттерны: минимальный порог наблюдений + weight-of-evidence для коррекции. (Сложность: средняя; Затраты: низкие)
    Результат:
    Промежуточные изменения:
10. [ ] Режимные веса ансамбля: веса моделей зависят от vol_z/volume_z. (Сложность: средняя; Затраты: низкие)
    Результат:
    Промежуточные изменения:
11. [ ] Режимные модели: отдельные профили low-vol / high-vol. (Сложность: высокая; Затраты: высокие)
    Результат:
    Промежуточные изменения:
12. [ ] Meta-classifier над outputs+features (логистическая/GBM). (Сложность: высокая; Затраты: средние)
    Результат:
    Промежуточные изменения:
13. [ ] Многомасштабные нормализации/z-score (окна 5/20/60) без смены TF. (Сложность: средняя; Затраты: низкие)
    Результат:
    Промежуточные изменения:
14. [ ] Добавить свечные фичи 1m: range (high-low), body (close-open), хвосты, ATR-like, "напряжение". (Сложность: низкая; Затраты: низкие)
    Результат:
    Промежуточные изменения:
15. [ ] TRENDVIC: тренд-strength на нескольких окнах. (Сложность: средняя; Затраты: низкие)
    Результат:
    Промежуточные изменения:
16. [ ] VOLUMEMETRIX: зависимость объема от волатильности (объем/волатильность и режимы). (Сложность: низкая; Затраты: низкие)
    Результат:
    Промежуточные изменения:
17. [ ] OSCILLATOR: RSI + Stoch (или близкие осцилляторы). (Сложность: низкая; Затраты: низкие)
    Результат:
    Промежуточные изменения:
18. [ ] Контроль дрейфа распределений фич (volatility_z, volume_z, ma_delta) и сигнал смены режима. (Сложность: средняя; Затраты: средние)
    Результат:
    Промежуточные изменения:
19. [ ] Лимиты и защита от деградации: авто-повышение порогов при падении качества. (Сложность: средняя; Затраты: низкие)
    Результат:
    Промежуточные изменения:
20. [ ] Метрики стабильности: rolling accuracy, ECE/MCE, доля уверенных ошибок, баланс направлений. (Сложность: средняя; Затраты: низкие)
    Результат:
    Промежуточные изменения:
21. [ ] Мониторинг лагов и задержек: сбор данных -> прогноз -> запись (1m соответствие). (Сложность: низкая; Затраты: низкие)
    Результат:
    Промежуточные изменения:
22. [ ] Витрина данных: стандартизировать запись решений, исходов и контекста. (Сложность: низкая; Затраты: низкие)
    Результат:
    Промежуточные изменения:
23. [ ] Регулярные исторические тесты по расписанию (2h/6h/24h) с архивом отчетов. (Сложность: низкая; Затраты: низкие)
    Результат:
    Промежуточные изменения: ручной прогон `runs/history_ws_stable` на 2 часа для контроля базового качества.
